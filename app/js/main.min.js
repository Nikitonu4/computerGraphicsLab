class ViewGraphics{constructor(t){this.ctx=t,this.coordinatesRectangle={},this.LEFT=1,this.RIGHT=2,this.BOTTOM=4,this.TOP=8}clear(){const t=this.ctx.canvas.width,e=this.ctx.canvas.height;this.ctx.fillStyle="#fff",this.ctx.fillRect(0,0,t,e),this.ctx.fillStyle="#000"}DDA(t,e,i,n){const s=i-t,o=n-e,a=Math.abs(s)>Math.abs(o)?Math.abs(s):Math.abs(o),c=1*s/a,l=1*o/a;let r=t,h=e;this.fillPixel(t,e);for(let t=0;t<a;t++)r+=c,h+=l,this.fillPixel(r,h)}brezenhem(t,e,i,n){let s=Math.abs(i-t),o=Math.abs(n-e),a=t<i?1:-1,c=e<n?1:-1,l=s-o;for(this.fillPixel(i,n);t!=i||e!=n;){this.fillPixel(t,e);let i=2*l;i>-o&&(l-=o,t+=a),i<s&&(l+=s,e+=c)}}circleBrezenhem(t,e,i){let n=0,s=i,o=1-2*i,a=0;for(;s>=n;)this.fillPixel(t+n,e+s),this.fillPixel(t+n,e-s),this.fillPixel(t-n,e+s),this.fillPixel(t-n,e-s),this.fillPixel(t+s,e+n),this.fillPixel(t+s,e-n),this.fillPixel(t-s,e+n),this.fillPixel(t-s,e-n),a=2*(o+s)-1,o<0&&a<=0?o+=2*++n+1:o>0&&a>0?o-=2*--s+1:o+=2*(++n- --s)}factorial(t){let e=1;for(let i=1;i<=t;i++)e*=i;return e}polBershtein(t,e,i){return this.factorial(e)/(this.factorial(t)*this.factorial(e-t))*Math.pow(i,t)*Math.pow(1-i,e-t)}bezie(t){let e=0;const i=[];for(let n=0;n<1;n+=.001){let s=0,o=0;for(let e=0;e<3;e++){const i=this.polBershtein(e,t.length-1,n);o+=t[e].x*i,s+=t[e].y*i}i[e]={x:o,y:s},e++}for(let t=0;t<i.length;t++)this.fillPixel(i[t].x,i[t].y)}createRectangle(t,e,i,n){this.coordinatesRectangle.x0=t,this.coordinatesRectangle.y0=e,this.coordinatesRectangle.x1=i,this.coordinatesRectangle.y1=n,this.ctx.strokeStyle="#000",this.ctx.strokeRect(t,e,i-t,n-e)}getCode(t){let e=0;return t.x<this.coordinatesRectangle.x0&&(e+=this.LEFT),t.x>this.coordinatesRectangle.x1&&(e+=this.RIGHT),t.y<this.coordinatesRectangle.y0&&(e+=this.BOTTOM),t.y>this.coordinatesRectangle.y1&&(e+=this.TOP),e}koenSaz(t,e,i,n){let s,o=[{x:t,y:e},{x:i,y:n}],a={},c=this.getCode(o[0]),l=this.getCode(o[1]);for(;c|l;){if(c&l)return;0|c?(s=c,a=o[0]):(s=l,a=o[1]),s&this.LEFT?(a.y+=(o[0].y-o[1].y)*(this.coordinatesRectangle.x0-a.x)/(o[0].x-o[1].x),a.x=this.coordinatesRectangle.x0):s&this.RIGHT?(a.y+=(o[0].y-o[1].y)*(this.coordinatesRectangle.x1-a.x)/(o[0].x-o[1].x),a.x=this.coordinatesRectangle.x1):s&this.BOTTOM?(a.x+=(o[0].x-o[1].x)*(this.coordinatesRectangle.y0-a.y)/(o[0].y-o[1].y),a.y=this.coordinatesRectangle.y0):s&this.TOP&&(a.x+=(o[0].x-o[1].x)*(this.coordinatesRectangle.y1-a.y)/(o[0].y-o[1].y),a.y=this.coordinatesRectangle.y1),s===c?(o[0]=a,c=this.getCode(o[0])):(o[1]=a,l=this.getCode(o[1]))}this.DDA(o[0].x,o[0].y,o[1].x,o[1].y)}isInside(t,e){return this.coordinatesRectangle.x0<=t&&this.coordinatesRectangle.x1>=t&&this.coordinatesRectangle.y0<=e&&this.coordinatesRectangle.y1>=e}midPoint(t,e,i,n){if(Math.abs(t-i)<=1&&Math.abs(e-n)<=1)return;if(this.isInside(t,e)&&this.isInside(i,n))return void this.DDA(t,e,i,n);this.getCode({x:t,y:e})&this.getCode({x:i,y:n})||(this.midPoint(t,e,(t+i)/2,(e+n)/2),this.midPoint((t+i)/2,(e+n)/2,i,n))}fillPixel(t,e){this.ctx.fillRect(t,e,1,1)}}const controlPanel=document.querySelector(".control__panel"),canvas=document.querySelector("#canvas"),ctx=canvas.getContext("2d"),radioBox=document.querySelector(".control__panel-radiogroup"),createRectangle=document.querySelector(".rectangle"),clearButton=document.querySelector(".clear");let nowAlg=1;const viewGraphics=new ViewGraphics(ctx);canvas.width=window.innerWidth,canvas.height=window.innerHeight;let Arr=[],startCoordinates={x:0,y:0},countBezie=0;function selectAnAlgorithm(){nowAlg=+document.querySelector("input[name=radio-cust]:checked").value}function dragElement(t){let e=0,i=0,n=0,s=0;function o(t){(t=t||window.event).preventDefault(),n=t.clientX,s=t.clientY,document.onmouseup=c,document.onmousemove=a}function a(o){(o=o||window.event).preventDefault(),e=n-o.clientX,i=s-o.clientY,n=o.clientX,s=o.clientY,t.style.top=t.offsetTop-i+"px",t.style.left=t.offsetLeft-e+"px"}function c(){document.onmouseup=null,document.onmousemove=null}document.querySelector(`.${t.className}-header`)?document.querySelector(`.${t.className}-header`).onmousedown=o:t.onmousedown=o}clearButton.addEventListener("click",()=>{viewGraphics.clear()}),createRectangle.addEventListener("click",()=>{nowAlg=5}),radioBox.addEventListener("click",()=>{selectAnAlgorithm()}),canvas.addEventListener("mousedown",t=>{4==nowAlg&&(Arr.push({x:t.clientX,y:t.clientY}),countBezie++),startCoordinates={x:t.clientX,y:t.clientY}}),canvas.addEventListener("mouseup",t=>{switch(nowAlg){case 1:viewGraphics.DDA(startCoordinates.x,startCoordinates.y,t.clientX,t.clientY);break;case 2:viewGraphics.brezenhem(startCoordinates.x,startCoordinates.y,t.clientX,t.clientY);break;case 3:const e=Math.sqrt(Math.pow(t.clientX-startCoordinates.x,2)+Math.pow(t.clientY-startCoordinates.y,2));viewGraphics.circleBrezenhem(startCoordinates.x,startCoordinates.y,e);break;case 4:3==countBezie&&(viewGraphics.bezie(Arr),countBezie=0,Arr=[]);break;case 5:viewGraphics.createRectangle(startCoordinates.x,startCoordinates.y,t.clientX,t.clientY);break;case 6:viewGraphics.koenSaz(startCoordinates.x,startCoordinates.y,t.clientX,t.clientY);break;case 7:viewGraphics.midPoint(startCoordinates.x,startCoordinates.y,t.clientX,t.clientY)}ctx.beginPath()}),dragElement(controlPanel);