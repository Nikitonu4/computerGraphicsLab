class ViewGraphics{constructor(e){this.ctx=e}clear(){const e=ctx.canvas.width,t=ctx.canvas.height;this.ctx.fillStyle="#fff",this.ctx.fillRect(0,0,e,t),this.ctx.fillStyle="#000"}DDA(e,t,n,i){const l=n-e,o=i-t,c=Math.abs(l)>Math.abs(o)?Math.abs(l):Math.abs(o),a=1*l/c,r=1*o/c;let s=e,h=t;this.fillPixel(e,t);for(let e=0;e<c;e++)s+=a,h+=r,this.fillPixel(s,h)}brezenhem(e,t,n,i){let l=Math.abs(n-e),o=Math.abs(i-t),c=e<n?1:-1,a=t<i?1:-1,r=l-o;for(this.fillPixel(n,i);e!=n||t!=i;){this.fillPixel(e,t);let n=2*r;n>-o&&(r-=o,e+=c),n<l&&(r+=l,t+=a)}}circleBrezenhem(e,t,n){let i=0,l=n,o=1-2*n,c=0;for(;l>=i;)this.fillPixel(e+i,t+l),this.fillPixel(e+i,t-l),this.fillPixel(e-i,t+l),this.fillPixel(e-i,t-l),this.fillPixel(e+l,t+i),this.fillPixel(e+l,t-i),this.fillPixel(e-l,t+i),this.fillPixel(e-l,t-i),c=2*(o+l)-1,o<0&&c<=0?o+=2*++i+1:o>0&&c>0?o-=2*--l+1:o+=2*(++i- --l)}factorial(e){let t=1;for(let n=1;n<=e;n++)t*=n;return t}polBershtein(e,t,n){return this.factorial(t)/(this.factorial(e)*this.factorial(t-e))*Math.pow(n,e)*Math.pow(1-n,t-e)}bezie(e){let t=0;const n=[];for(let i=0;i<1;i+=.001){let l=0,o=0;for(let t=0;t<3;t++){const n=this.polBershtein(t,e.length-1,i);o+=e[t].x*n,l+=e[t].y*n}n[t]={x:o,y:l},t++}for(let e=0;e<n.length;e++)this.fillPixel(n[e].x,n[e].y)}createRectangle(e){this.ctx.strokeStyle="#000",this.ctx.strokeRect(e.x0,e.y0,e.x1-e.x0,e.y1-e.y0)}fillPixel(e,t){this.ctx.fillRect(e,t,1,1)}}const controlPanel=document.querySelector(".control__panel"),canvas=document.querySelector("#canvas"),ctx=canvas.getContext("2d"),radioBox=document.querySelector(".control__panel-radiogroup"),createRectangle=document.querySelector(".rectangle"),clearButton=document.querySelector(".clear");let nowAlg=1;const viewGraphics=new ViewGraphics(ctx);canvas.width=window.innerWidth,canvas.height=window.innerHeight;let isMouseDown=!1,Arr=[],startCoordinates={x:0,y:0};const rectangleCoordinates={x0:0,y0:0,x1:0,y1:0};let countBezie=0;function selectAnAlgorithm(){nowAlg=+document.querySelector("input[name=radio-cust]:checked").value}function dragElement(e){let t=0,n=0,i=0,l=0;function o(e){(e=e||window.event).preventDefault(),i=e.clientX,l=e.clientY,document.onmouseup=a,document.onmousemove=c}function c(o){(o=o||window.event).preventDefault(),t=i-o.clientX,n=l-o.clientY,i=o.clientX,l=o.clientY,e.style.top=e.offsetTop-n+"px",e.style.left=e.offsetLeft-t+"px"}function a(){document.onmouseup=null,document.onmousemove=null}document.querySelector(`.${e.className}-header`)?document.querySelector(`.${e.className}-header`).onmousedown=o:e.onmousedown=o}clearButton.addEventListener("click",()=>{viewGraphics.clear()}),createRectangle.addEventListener("click",()=>{nowAlg=5}),radioBox.addEventListener("click",()=>{selectAnAlgorithm()}),canvas.addEventListener("mousedown",e=>{isMouseDown=!0,4==nowAlg&&(Arr.push({x:e.clientX,y:e.clientY}),countBezie++),5==nowAlg&&(rectangleCoordinates.x0=e.clientX,rectangleCoordinates.y0=e.clientY),startCoordinates={x:e.clientX,y:e.clientY}}),canvas.addEventListener("mouseup",e=>{switch(isMouseDown=!1,5==nowAlg&&(rectangleCoordinates.x1=e.clientX,rectangleCoordinates.y1=e.clientY),nowAlg){case 1:viewGraphics.DDA(startCoordinates.x,startCoordinates.y,e.clientX,e.clientY);break;case 2:viewGraphics.brezenhem(startCoordinates.x,startCoordinates.y,e.clientX,e.clientY);break;case 3:const t=Math.sqrt(Math.pow(e.clientX-startCoordinates.x,2)+Math.pow(e.clientY-startCoordinates.y,2));viewGraphics.circleBrezenhem(startCoordinates.x,startCoordinates.y,t);break;case 4:3==countBezie&&(viewGraphics.bezie(Arr),countBezie=0,Arr=[]);break;case 5:viewGraphics.createRectangle(rectangleCoordinates)}ctx.beginPath()}),canvas.addEventListener("mousemove",e=>{}),dragElement(controlPanel);