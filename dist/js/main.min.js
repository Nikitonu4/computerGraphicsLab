class ViewGraphics{constructor(e){this.ctx=e,this.coordinatesRectangle={},this.LEFT=1,this.RIGHT=2,this.BOTTOM=4,this.TOP=8}clear(){const e=ctx.canvas.width,t=ctx.canvas.height;this.ctx.fillStyle="#fff",this.ctx.fillRect(0,0,e,t),this.ctx.fillStyle="#000"}DDA(e,t,i,n){const s=i-e,o=n-t,a=Math.abs(s)>Math.abs(o)?Math.abs(s):Math.abs(o),c=1*s/a,l=1*o/a;let r=e,h=t;this.fillPixel(e,t);for(let e=0;e<a;e++)r+=c,h+=l,this.fillPixel(r,h)}brezenhem(e,t,i,n){let s=Math.abs(i-e),o=Math.abs(n-t),a=e<i?1:-1,c=t<n?1:-1,l=s-o;for(this.fillPixel(i,n);e!=i||t!=n;){this.fillPixel(e,t);let i=2*l;i>-o&&(l-=o,e+=a),i<s&&(l+=s,t+=c)}}circleBrezenhem(e,t,i){let n=0,s=i,o=1-2*i,a=0;for(;s>=n;)this.fillPixel(e+n,t+s),this.fillPixel(e+n,t-s),this.fillPixel(e-n,t+s),this.fillPixel(e-n,t-s),this.fillPixel(e+s,t+n),this.fillPixel(e+s,t-n),this.fillPixel(e-s,t+n),this.fillPixel(e-s,t-n),a=2*(o+s)-1,o<0&&a<=0?o+=2*++n+1:o>0&&a>0?o-=2*--s+1:o+=2*(++n- --s)}factorial(e){let t=1;for(let i=1;i<=e;i++)t*=i;return t}polBershtein(e,t,i){return this.factorial(t)/(this.factorial(e)*this.factorial(t-e))*Math.pow(i,e)*Math.pow(1-i,t-e)}bezie(e){let t=0;const i=[];for(let n=0;n<1;n+=.001){let s=0,o=0;for(let t=0;t<3;t++){const i=this.polBershtein(t,e.length-1,n);o+=e[t].x*i,s+=e[t].y*i}i[t]={x:o,y:s},t++}for(let e=0;e<i.length;e++)this.fillPixel(i[e].x,i[e].y)}createRectangle(e,t,i,n){this.coordinatesRectangle.x0=e,this.coordinatesRectangle.y0=t,this.coordinatesRectangle.x1=i,this.coordinatesRectangle.y1=n,this.ctx.strokeStyle="#000",this.ctx.strokeRect(e,t,i-e,n-t)}getCode(e){let t=0;return e.x<this.coordinatesRectangle.x0&&(t+=this.LEFT),e.x>this.coordinatesRectangle.x1&&(t+=this.RIGHT),e.y<this.coordinatesRectangle.y0&&(t+=this.BOTTOM),e.y>this.coordinatesRectangle.y1&&(t+=this.TOP),t}koenSaz(e,t,i,n){let s,o=[{x:e,y:t},{x:i,y:n}],a={},c=this.getCode(o[0]),l=this.getCode(o[1]);for(;c|l;){if(c&l)return;0|c?(s=c,a=o[0]):(s=l,a=o[1]),s&this.LEFT?(a.y+=(o[0].y-o[1].y)*(this.coordinatesRectangle.x0-a.x)/(o[0].x-o[1].x),a.x=this.coordinatesRectangle.x0):s&this.RIGHT?(a.y+=(o[0].y-o[1].y)*(this.coordinatesRectangle.x1-a.x)/(o[0].x-o[1].x),a.x=this.coordinatesRectangle.x1):s&this.BOTTOM?(a.x+=(o[0].x-o[1].x)*(this.coordinatesRectangle.y0-a.y)/(o[0].y-o[1].y),a.y=this.coordinatesRectangle.y0):s&this.TOP&&(a.x+=(o[0].x-o[1].x)*(this.coordinatesRectangle.y1-a.y)/(o[0].y-o[1].y),a.y=this.coordinatesRectangle.y1),s===c?(o[0]=a,c=this.getCode(o[0])):(o[1]=a,l=this.getCode(o[1]))}this.DDA(o[0].x,o[0].y,o[1].x,o[1].y)}isInside(e,t){return this.coordinatesRectangle.x0<=e&&this.coordinatesRectangle.x1>=e&&this.coordinatesRectangle.y0<=t&&this.coordinatesRectangle.y1>=t}midPoint(e,t,i,n){if(Math.abs(e-i)<=1&&Math.abs(t-n)<=1)return;if(this.isInside(e,t)&&this.isInside(i,n))return void this.DDA(e,t,i,n);this.getCode({x:e,y:t})&this.getCode({x:i,y:n})||(this.midPoint(e,t,(e+i)/2,(t+n)/2),this.midPoint((e+i)/2,(t+n)/2,i,n))}fillPixel(e,t){this.ctx.fillRect(e,t,1,1)}}const controlPanel=document.querySelector(".control__panel"),canvas=document.querySelector("#canvas"),ctx=canvas.getContext("2d"),radioBox=document.querySelector(".control__panel-radiogroup"),createRectangle=document.querySelector(".rectangle"),clearButton=document.querySelector(".clear");let nowAlg=1;const viewGraphics=new ViewGraphics(ctx);canvas.width=window.innerWidth,canvas.height=window.innerHeight;let isMouseDown=!1,Arr=[],startCoordinates={x:0,y:0};const rectangleCoordinates={x0:0,y0:0,x1:0,y1:0};let countBezie=0;function selectAnAlgorithm(){nowAlg=+document.querySelector("input[name=radio-cust]:checked").value}function dragElement(e){let t=0,i=0,n=0,s=0;function o(e){(e=e||window.event).preventDefault(),n=e.clientX,s=e.clientY,document.onmouseup=c,document.onmousemove=a}function a(o){(o=o||window.event).preventDefault(),t=n-o.clientX,i=s-o.clientY,n=o.clientX,s=o.clientY,e.style.top=e.offsetTop-i+"px",e.style.left=e.offsetLeft-t+"px"}function c(){document.onmouseup=null,document.onmousemove=null}document.querySelector(`.${e.className}-header`)?document.querySelector(`.${e.className}-header`).onmousedown=o:e.onmousedown=o}clearButton.addEventListener("click",()=>{viewGraphics.clear()}),createRectangle.addEventListener("click",()=>{nowAlg=5}),radioBox.addEventListener("click",()=>{selectAnAlgorithm()}),canvas.addEventListener("mousedown",e=>{isMouseDown=!0,4==nowAlg&&(Arr.push({x:e.clientX,y:e.clientY}),countBezie++),startCoordinates={x:e.clientX,y:e.clientY}}),canvas.addEventListener("mouseup",e=>{switch(isMouseDown=!1,nowAlg){case 1:viewGraphics.DDA(startCoordinates.x,startCoordinates.y,e.clientX,e.clientY);break;case 2:viewGraphics.brezenhem(startCoordinates.x,startCoordinates.y,e.clientX,e.clientY);break;case 3:const t=Math.sqrt(Math.pow(e.clientX-startCoordinates.x,2)+Math.pow(e.clientY-startCoordinates.y,2));viewGraphics.circleBrezenhem(startCoordinates.x,startCoordinates.y,t);break;case 4:3==countBezie&&(viewGraphics.bezie(Arr),countBezie=0,Arr=[]);break;case 5:viewGraphics.createRectangle(startCoordinates.x,startCoordinates.y,e.clientX,e.clientY);break;case 6:viewGraphics.koenSaz(startCoordinates.x,startCoordinates.y,e.clientX,e.clientY);break;case 7:viewGraphics.midPoint(startCoordinates.x,startCoordinates.y,e.clientX,e.clientY)}ctx.beginPath()}),dragElement(controlPanel);